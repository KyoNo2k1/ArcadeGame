{"ast":null,"code":"import _defineProperty from\"C:/Users/nghia/Documents/arcade/front-end/user_website/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/nghia/Documents/arcade/front-end/user_website/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/nghia/Documents/arcade/front-end/user_website/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useCallback,useEffect,useState}from\"react\";import axios from'axios';var useForm=function useForm(FormType,formRef,setShowForm,validator,user,setDialogState){var default_values=useCallback(function(){if(FormType===\"Login\"){return{Email:\"\",Password:\"\"};}if(FormType===\"SignUp\"){return{Full_name:\"\",Email:\"\",Password:\"\",Confirm_password:\"\",Gender:1};}if(FormType===\"ForgotPassword\"){return{Email:\"\"};}if(FormType===\"ChangePassword\"){return{Old_password:\"\",New_password:\"\",Confirm_password:\"\"};}},[FormType]);var _useState=useState(default_values),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var handleChange=function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;if(name===\"Gender\")value=Number(value);setValues(_objectSpread(_objectSpread({},values),{},_defineProperty({},name,value)));};var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),errors=_useState4[0],setErrors=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isSubmitted=_useState6[0],setIsSubmitted=_useState6[1];var handleSubmit=function handleSubmit(e){e.preventDefault();setErrors({});setErrors(validator(FormType,values));setIsSubmitted(true);};useEffect(function(){if(isSubmitted&&Object.keys(errors).length===0){if(FormType===\"Login\"){axios.post('user/login',values).then(function(res){if(res.data.message==='Authentication successful!'){localStorage.setItem('token',res.data.token);axios.defaults.headers.common['Authorization']=res.data.token;setShowForm(false);}}).catch(function(err){if(err.message===\"Request failed with status code 401\"){setErrors(validator(FormType,'Wrong email or password!'));}else{setDialogState({title:\"Error!\",message:err.message,show:true});}});}if(FormType===\"SignUp\"){axios.post('user/sign-up',values).then(function(res){setDialogState({title:\"Notify!\",message:res.data.message,show:true});setShowForm(false);}).catch(function(err){setDialogState({title:\"Error!\",message:err.message,show:true});});}if(FormType===\"ForgotPassword\"){axios.post('user/forgot-password',values).then(function(res){setDialogState({title:\"Notify!\",message:\"Your password have been reset successfully! Please check your email for new password! (Make sure to check spam too)\",show:true});setShowForm(false);}).catch(function(err){setDialogState({title:\"Error!\",message:err.message,show:true});});}if(FormType===\"ChangePassword\"){var config={headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}};axios.post(\"user/change-password/\"+user.id,values,config).then(function(res){setDialogState({title:\"Notify!\",message:\"An email has just been sended to \"+values.Email+\". Please check your email to confirm reset!\",show:true});setShowForm(false);}).catch(function(err){setDialogState({title:\"Error!\",message:err.message,show:true});});}setValues(default_values);setIsSubmitted(false);}},[errors,FormType,default_values,isSubmitted,setDialogState,setShowForm,validator,values,user]);var handleClose=function handleClose(e){if(formRef.current===e.target||e.target.className===\"close-btn\"){setIsSubmitted(false);setValues(default_values);setErrors({});setShowForm(false);}};return{handleSubmit:handleSubmit,handleClose:handleClose,handleChange:handleChange,values:values,errors:errors};};export default useForm;","map":{"version":3,"sources":["C:/Users/nghia/Documents/arcade/front-end/user_website/src/Components/Popup/Form/useForm.jsx"],"names":["useCallback","useEffect","useState","axios","useForm","FormType","formRef","setShowForm","validator","user","setDialogState","default_values","Email","Password","Full_name","Confirm_password","Gender","Old_password","New_password","values","setValues","handleChange","e","target","name","value","Number","errors","setErrors","isSubmitted","setIsSubmitted","handleSubmit","preventDefault","Object","keys","length","post","then","res","data","message","localStorage","setItem","token","defaults","headers","common","catch","err","title","show","config","Authorization","getItem","id","handleClose","current","className"],"mappings":"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","sourcesContent":["import { useCallback, useEffect, useState } from \"react\";\r\nimport axios from 'axios';\r\n\r\nconst useForm = (FormType, formRef, setShowForm, validator, user, setDialogState) => {\r\n    const default_values = useCallback(() => {\r\n        if (FormType === \"Login\"){\r\n            return {\r\n                Email: \"\",\r\n                Password: \"\"\r\n            }\r\n        }\r\n        if (FormType === \"SignUp\"){\r\n            return {\r\n                Full_name: \"\",\r\n                Email: \"\",\r\n                Password: \"\",\r\n                Confirm_password: \"\",\r\n                Gender: 1\r\n            }\r\n        }\r\n\r\n        if (FormType === \"ForgotPassword\"){\r\n            return {\r\n                Email: \"\"\r\n            }\r\n        }\r\n\r\n        if (FormType === \"ChangePassword\"){\r\n            return {\r\n                Old_password: \"\",\r\n                New_password: \"\",\r\n                Confirm_password: \"\"\r\n            }\r\n        }\r\n    }, [FormType])\r\n\r\n    const [values, setValues] = useState(default_values)\r\n\r\n    const handleChange = e => {\r\n        let { name, value } = e.target\r\n        if (name === \"Gender\") value = Number(value);\r\n        setValues({\r\n            ...values,\r\n            [name]: value\r\n        })\r\n    }\r\n\r\n    const [errors, setErrors] = useState({});\r\n    const [isSubmitted, setIsSubmitted] = useState(false)\r\n\r\n    const handleSubmit = e => {\r\n        e.preventDefault();\r\n        \r\n        setErrors({});\r\n        setErrors(validator(FormType, values));\r\n\r\n        setIsSubmitted(true);\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (isSubmitted && Object.keys(errors).length === 0){\r\n            if (FormType === \"Login\"){\r\n                axios.post('user/login', values).then(\r\n                    res => {\r\n                        if (res.data.message === 'Authentication successful!'){\r\n                            localStorage.setItem('token', res.data.token);\r\n                            axios.defaults.headers.common['Authorization'] = res.data.token;\r\n                            setShowForm(false)\r\n                        }\r\n                    }\r\n                ).catch(\r\n                    err => {\r\n                        if (err.message === \"Request failed with status code 401\"){\r\n                            setErrors(validator(FormType, 'Wrong email or password!'))\r\n                        }\r\n                        else{\r\n                            setDialogState({\r\n                                title: \"Error!\",\r\n                                message: err.message,\r\n                                show: true\r\n                            })\r\n                        }\r\n                    }\r\n                )  \r\n            }\r\n            if (FormType === \"SignUp\"){\r\n                axios.post('user/sign-up', values).then(\r\n                    res => {\r\n                        setDialogState({\r\n                            title: \"Notify!\",\r\n                            message: res.data.message,\r\n                            show: true\r\n                        });\r\n                        setShowForm(false);\r\n                    }\r\n                ).catch(\r\n                    err => {\r\n                        setDialogState({\r\n                            title: \"Error!\",\r\n                            message: err.message,\r\n                            show: true\r\n                        })\r\n                    }\r\n                )\r\n            }\r\n    \r\n            if (FormType === \"ForgotPassword\"){\r\n                axios.post('user/forgot-password', values).then(\r\n                    res => {\r\n                        setDialogState({\r\n                            title: \"Notify!\",\r\n                            message: \"Your password have been reset successfully! Please check your email for new password! (Make sure to check spam too)\",\r\n                            show: true\r\n                        })\r\n                        setShowForm(false)\r\n                    }\r\n                ).catch(\r\n                    err => {\r\n                        setDialogState({\r\n                            title: \"Error!\",\r\n                            message: err.message,\r\n                            show: true\r\n                        })\r\n                    }\r\n                )\r\n            }\r\n\r\n            if (FormType === \"ChangePassword\"){\r\n                const config = {\r\n                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }\r\n                };\r\n                \r\n                axios.post(\"user/change-password/\" + user.id, values, config).then(res => {\r\n                    setDialogState({\r\n                        title: \"Notify!\",\r\n                        message: \"An email has just been sended to \" + values.Email + \". Please check your email to confirm reset!\",\r\n                        show: true\r\n                    })\r\n                    setShowForm(false)\r\n                }).catch(\r\n                    err => {\r\n                        setDialogState({\r\n                            title: \"Error!\",\r\n                            message: err.message,\r\n                            show: true\r\n                        })\r\n                    }\r\n                )\r\n            }\r\n\r\n            setValues(default_values);\r\n            setIsSubmitted(false);\r\n        }\r\n    }, [errors, FormType, default_values, isSubmitted, setDialogState, setShowForm, validator, values, user])\r\n\r\n    const handleClose = (e) => {\r\n        if (formRef.current === e.target || e.target.className === \"close-btn\"){\r\n            setIsSubmitted(false)\r\n            setValues(default_values)\r\n            setErrors({})\r\n            setShowForm(false)\r\n        }\r\n    }\r\n\r\n    return { handleSubmit, handleClose, handleChange, values , errors }\r\n}\r\n\r\nexport default useForm;"]},"metadata":{},"sourceType":"module"}